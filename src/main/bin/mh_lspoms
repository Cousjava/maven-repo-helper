#!/bin/bash

VERBOSE=true
if [ "$1" = "-q" ]; then
    VERBOSE=false
    shift
fi

PACKAGE=$1

if [ -z "$PACKAGE" ]; then
    echo "Syntax:"
    echo "mh_lspoms <binary package>"
    exit 1
fi

if [ ! -z "${PACKAGE##-p}" ]; then
    PACKAGE=${PACKAGE##-p}
fi

if [ -e debian/$PACKAGE.poms ]; then
  if $VERBOSE ; then
    echo debian/$PACKAGE.poms already exist. Please delete it if you want to regenerate it.
  fi
else
  mkdir -p debian
  find . -path '*/.*' -prune -o -path './debian/tmp' -prune -o -type f -name 'pom.xml' -print | sed s,./,, | sed -e's,^\(debian/pom\.xml\|pom\.xml\),\1 --debian-parent,' > debian/$PACKAGE.poms
  if $VERBOSE ; then
    echo The list of POM files is now in debian/$PACKAGE.poms
  fi
fi

